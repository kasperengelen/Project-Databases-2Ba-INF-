{% extends 'layout.html' %}

{% block body %}
	<div class="jumbotron text-center" style="padding: 1%">
		{% if perm_type == "admin" %}
			<div style="float: right;">
				<a style="float: right;" href="{{ url_for('dataset_pages.manage_dataset', dataset_id=dataset_info.setid) }}" 
					class="btn btn-primary">Manage</a>
				</br>
				</br>
				<a href="{{ url_for('dataset_pages.edit_perms_dataset', dataset_id=dataset_info.setid) }}" 
					class="btn btn-primary">Permissions</a>
			</div>
		{% endif %}
		<a style="float: left;" href="{{ url_for('dataset_pages.list_dataset') }}" class="btn btn-primary">Datasets</a>
			<h2 style="float: center;">{{ dataset_info.name }}</h2>
			<p style="float: center;">{{ dataset_info.desc }}</p>
	</div>

	{% if perm_type == "admin" or perm_type == "write" %}
		<div class="panel-group" id="accordion">
		    <div class="panel panel-default">
		      	<div class="panel-heading">
		        	<h4 class="panel-title">
		          		<a data-toggle="collapse" data-parent="#accordion" href="#add">Add Table</a>
		        	</h4>
		      	</div>
		      	<div id="add" class="panel-collapse collapse">
		        	<div class="panel-body">
		        		{% from "includes/_formhelpers.html" import render_field %}
						<form method="post" enctype="multipart/form-data" action="{{ url_for('dataset_pages.upload', 
						dataset_id=dataset_info.setid) }}">
							{{ form.hidden_tag() }}
							<div class="form-group" style="width: 50%;">
	                 			{{render_field(form.data_file, class_="form-control")}}  
	                		</div>
	                		<p style="display: inline-block;">Column names included? (Only CSV)     </p>
	                		<div class="form-group" style="display: inline-block;">
	                			{{ form.columnnames_included }}
	                		</div>
							<p><input type="submit" class="btn btn-primary" value="Upload File"></p>
						</form>
						<p>Allowed extensions: .csv, .zip, .dump</p>
		        	</div>
		      	</div>
		    </div>
		    <div class="panel panel-default">
		      	<div class="panel-heading">
		        	<h4 class="panel-title">
		         		<a data-toggle="collapse" data-parent="#accordion" href="#join">Join Tables</a>
		        	</h4>
		      	</div>
		      	<div id="join" class="panel-collapse collapse">
		        	<div class="panel-body">	
		        		Join Form
		        	</div>
	     		</div>
	    	</div>
	  	</div>		
	{% endif %}

    <div class="jumbotron">
		<table>
			{% if table_list %}
				<tr>
					<th>Tables</th>
					<th></th>
				</tr>

				{% for table in table_list %}
				<tr>
					<td><a href="{{ url_for('dataset_pages.view_dataset_table', dataset_id=dataset_info.setid, tablename=table) }}">
						{{ table }}</a></td>
					<td><a id="file" href="#" onclick="return exprt()">Export to CSV</a></td>
				</tr>
				<script>
					function exprt() {
						var filename
						var p = prompt("Please enter the filename:", "file");
					    if (p == null || p == "") {
					        filename = "";
					    } else {
					        filename = "p";
					    }
					    document.getElementById("filename").innerHTML = filename;

					}
				</script>
				{% endfor %}
				
			{% endif %}
		</table>
	</div>


{% endblock %}
