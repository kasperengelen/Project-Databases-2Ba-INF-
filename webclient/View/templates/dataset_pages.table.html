{% extends 'layout.html' %}

{% block body %}
	<div class="jumbotron text-center" style="padding: 1%">
		{% if (perm_type == 'admin') %}
			<div class="pull-right" style="float: right;">
				<a style="float: right;" href="{{ url_for('dataset_pages.manage_dataset', dataset_id=dataset_info.setid) }}" class="btn btn-primary">Manage</a>
				</br>
				</br>
				<a href="{{ url_for('dataset_pages.edit_perms_dataset', dataset_id=dataset_info.setid) }}" 
					class="btn btn-primary">Permissions</a>
			</div>
		{% endif %}

		<a style="float: left;" href="{{ url_for('dataset_pages.view_dataset_home', dataset_id=dataset_info.setid) }}"
			class="btn btn-primary">Tables</a>
		<div class="text-center">

			<h2>{{ dataset_info.name }}</h2>
			<p>{{ dataset_info.desc }}</p>	
		</div>
	</div>    		

    <!--<div class="jumbotron">
    	<div class="text-center">
    		{% for index in page_indices %}
    			{% if index == "..." %}
    				<p style="display: inline-block;">...</p>
    			{% else %}
					<p style="display: inline-block;"><a style="color: black;"
						href="{{ url_for('dataset_pages.view_dataset_table', dataset_id=dataset_info.setid, tablename=tablename, page_nr=index) }}">
							{{ index }}</a></p>	
    			{% endif %}
    			
    		{% endfor %}
    	</div>    		

		<div class="pull-right" style="display: inline-block;">
			<input type="text" id="input" placeholder="Search Page No" style="border-style: solid; border-width: 1px; border-radius: 3px;"/>
			<button onclick="page_search()"><i class="glyphicon glyphicon-arrow-right"></i></button>

			<script type="text/javascript">
			function page_search(){
			    window.location.href = '/dataset/{{ dataset_info.setid }}/{{ tablename }}/' + document.getElementById('input').value;
			 }
			</script>
		</div>
	</div>-->
  
  	<div class="panel-group" id="accordion">
	    <div class="panel panel-default">
	      	<div class="panel-heading">
	        	<h4 class="panel-title">
	          		<a data-toggle="collapse" data-parent="#accordion" href="#view">View</a>
	        	</h4>
	      	</div>
	      	<div id="view" class="panel-collapse collapse">
	        	<div class="panel-body">{{perm_type }}</div>
	      	</div>
	    </div>
	    {% if (perm_type == 'admin' or perm_type == 'write') %}
		    <div class="panel panel-default">
		      	<div class="panel-heading">
		        	<h4 class="panel-title">
		         		<a data-toggle="collapse" data-parent="#accordion" href="#transform">Transform</a>
		        	</h4>
		      	</div>
		      	<div id="transform" class="panel-collapse collapse">
		        	<div class="panel-body">
		        	{% from "includes/_formhelpers.html" import render_field %}
					<form method="post" action="{{ url_for('dataset_pages.transform_findreplace', dataset_id=dataset_info.setid, tablename=table_name) }}">
					{{ findrepl_form.csrf_token }}
					<div class="form-group" style="width: 20%; display: inline-block;">
						{{render_field(findrepl_form.select_attr, class_="form-control")}}
					</div>
					<div class="form-group" style="width: 30%; display: inline-block;">
						{{render_field(findrepl_form.search, class_="form-control", placeholder="Searchterm")}}
					</div>
					<div class="form-group" style="width: 30%; display: inline-block;">
						{{render_field(findrepl_form.replacement, class_="form-control", placeholder="Replacement")}}  
					</div>
					<p style="display: inline-block;"><input type="submit" id="findrepl" class="btn btn-primary" value="Find & Replace"></p>
					</form>

					<form method="post" action="{{ url_for('dataset_pages.transform_deleteattr', dataset_id=dataset_info.setid, tablename=table_name) }}">
					{{ delete_form.csrf_token }}
					<div class="form-group" style="width: 30%; display: inline-block;">
						{{render_field(delete_form.select_attr, class_="form-control")}}
					</div>
					<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Delete Attribute"></p>
					</form>
			        </div>
	     		</div>
	    	</div>
	    {% endif %}
  	</div>	

	<div class="text-center">
		<style>
			table {
       			border-collapse: collapse;
        		width: 20%;
        		float:left;
				padding:3px;
				}

	        td, th {
	         	font-size: 15px;
	            text-align: left;
	            padding: 8px;
	            background-color: white;
	        }
		</style>
		<div>
			{{ table_data|safe }}
		</div>
		<script>
			$(document).ready( function () {
    			$('#mytable').DataTable( {
    				scrollX: true,
    				scrollY: true
    			} );
			} );
		</script>
	</div>

	

{% endblock %}
