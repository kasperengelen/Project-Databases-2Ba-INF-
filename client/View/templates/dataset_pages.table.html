{% extends 'layout.html' %}

{% block body %}
	<div class="jumbotron" style="padding: 1%;">
		<div class="row">
			<div class="col-sm-3 text-left">
				<a data-hover="tooltip" title="Previous" href="{{ url_for('dataset_pages.home', dataset_id=dataset_info.setid) }}" class="btn btn-primary">
					<span class="glyphicon glyphicon-share-alt" style="-webkit-transform: scaleX(-1); transform: scaleX(-1);"></span></a>
				</br>
				</br>
				</br>
				{% if original != True %}
				<div>
					<button id="transbutton" type="button" class="btn btn-primary" data-hover="tooltip" title="Transformations" data-toggle="collapse"
						onclick="return divClick();" data-target="#sidenav">
		                <span class="glyphicon glyphicon-menu-hamburger"></span>
		            </button>
		            <script>
		            	function divClick(){
		            		if($('#tablediv').hasClass("col-sm-12")){
		            			$('#tablediv').attr('class', 'col-sm-9');
		            		}
		            		else {
		            			$('#tablediv').attr('class', 'col-sm-12');
		            		}
		            	}
				    </script>
		            
				</div>
				{% endif %}
			</div>
			<div class="col-sm-6 text-center">
				<h2>{{ dataset_info.name }}</h2>
				{% if original != True %}
					<p>{{ dataset_info.desc }}</p>
				{% else %}
					<p>Original Table</p>
				{% endif %}
			</div>
			<div class="col-sm-3 text-right">
				
				<div>
					<a id="file" href="#" class="btn btn-primary" data-toggle="modal" data-hover="tooltip" title="Download" data-target="#downloadFormModal_{{ table }}">
						<span class="glyphicon glyphicon-download-alt"></span></a>
					{% include "includes/modals/_download_modal.html" %}
					</br>
					</br>
					</br>
					{% if original != True %}
					<a id="file" class="btn btn-primary" data-toggle="collapse" data-hover="tooltip" title="Statistics" data-parent="#accordion" href="#view">
						<span class="glyphicon glyphicon-stats"></span></a>
					{% endif %}
				</div>
			</div>
		</div>
	</div>  

	{% if original !=  True %}
		<div class="panel-group" id="accordion">
	      	<div id="view" class="panel-collapse collapse">
	        	<div class="panel-body">
	        		<div>
		        		<div>
		        			{% from "includes/_formhelpers.html" import render_field %}
		        			<form name="select_attr">
		        				{{ attr_form.hidden_tag() }}
				        		<div class="form-group" style="width: 20%;">
				        			{{render_field(attr_form.view_attr, class_="form-control")}}
				        		</div>
				        	</form>
			        	</div>
			       	    <div style="float: right;" id="col_stats"></div>
			        	</br>
			        	</br>
			        	</br>
			        	</br>
			        	</br>
			        	</br>
			        	<div>
				        	<div class="text-center" style="display: inline-block;" id="chart_freq"></div>
				        	<div class="text-center" style="display: inline-block;" id="hist_num"></div>
				        </div>

				    </div>
	        	</div>
	      	</div>
	    </div>
	{% endif %}
		
		  			  		


	  <div class="row">
	  		{% if original != True %}
			<div class="col-sm-3" style="position: sticky; top: 65px;">
				<nav class="navbar-default sidebar" style="border-radius: 5px; background-color: #e5e5e5;">
					<div class="container-fluid">
						<style>
							ul .nav .navbar-nav .sidebar li ul nav navbar-nav .collapse .sidebar li a .padding {
								padding-right: 6em; padding-left: 2em;
							}
						</style>
						
						<ul class="nav navbar-nav sidebar collapse out" id="sidenav">
				            <li><a href="#" data-toggle="modal" data-target="#tcmodal" onclick="$('#typeconversion_newtable').hide()">
				            	Attribute Type Conversion</a></li>

				            <li><a href="#" data-toggle="modal" data-target="#predicatemodal" onclick="$('#predicate_newtable').hide()">
				            	Delete Rows using Predicate</a></li>

				             <li><a href="#" data-toggle="modal" data-target="#deleteoutliersmodal" onclick="$('#deleteoutliers_newtable').hide()">
				            	Delete Outliers</a></li>

				            <li><a href="javascript: return void(0);" style="padding-right: 6em;" data-toggle="collapse" data-target="#navbar-collapse">
				            	Discretize&nbsp;&nbsp;<span class="glyphicon glyphicon-plus"></span></a>

								<ul class="nav navbar-nav collapse sidebar" id="navbar-collapse">
									<li><a href="#" style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#discretizewidthmodal" onclick="$('#discretizewidth_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>Equal Width</a></li>

									<li><a href="#" style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#discretizefreqmodal" onclick="$('#discretizefreq_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>Equal Frequency</a></li>

									<li><a href="#" style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#discretizecustommodal" onclick="$('#discretizecustom_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>Custom Range</a></li>
								</ul>
							</li>

							<li><a href="#" data-toggle="modal" data-target="#extractmodal" onclick="$('#extractdate_newtable').hide()">
				            	Extract Part of Date</a></li>

							<li><a href="javascript: void(0);" style="padding-right: 6em;" data-toggle="collapse" data-target="#navbar-collapse-2">
				            	Fill Nulls&nbsp;&nbsp;<span class="glyphicon glyphicon-plus"></span></a>

								<ul class="nav navbar-nav collapse sidebar" id="navbar-collapse-2">

									<li><a href="#" style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#fillnullsmeanmodal" onclick="$('#fillnullsmean_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>Mean</a></li>

									<li><a href="#" style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#fillnullsmedianmodal" onclick="$('#fillnullsmedian_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>Median</a></li>

									<li><a href="#" style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#fillnullscustommodal" onclick="$('#fillnullscustom_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>Custom Value</a></li>
								</ul>
							</li>

				            <li><a href="javascript: void(0);"  style="padding-right: 6em;" data-toggle="collapse" data-target="#navbar-collapse-1">
				            	Find and Replace&nbsp;&nbsp;<span class="glyphicon glyphicon-plus"></span></a>

								<ul class="nav navbar-nav collapse sidebar" id="navbar-collapse-1">
									<li><a style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#findreplacemodal" onclick="$('#findandreplace_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>Regular</a></li>

									<li><a style="padding-right: 6em; padding-left: 2em;" href="#"
										data-toggle="modal" data-target="#findreplaceregexmodal" onclick="$('#findandreplaceregex_newtable').hide()">
										<span class="glyphicon glyphicon-chevron-right">&nbsp;</span>With Regex</a></li>
								</ul>
							</li>

				           <li><a href="#" data-toggle="modal" data-target="#normalizemodal" onclick="$('#normalize_newtable').hide()">Normalize By Z-Score</a></li>

				            <li><a href="#" data-toggle="modal" data-target="#onehotencodemodal" onclick="$('#onehotencode_newtable').hide()">
				            	One Hot Encoding</a></li>
				        </ul>
					</div>
				</nav>
			</div>
			{% endif %}

			{% if original != True %}

				{% include "includes/modals/_type_conversion_modal.html" %}
				{% include "includes/modals/_find_replace_modal.html" %}
				{% include "includes/modals/_find_replace_regex_modal.html" %}
				{% include "includes/modals/_discretize_width_modal.html" %}
				{% include "includes/modals/_discretize_freq_modal.html" %}
				{% include "includes/modals/_discretize_custom_modal.html" %}
				{% include "includes/modals/_delete_outliers_modal.html" %}
				{% include "includes/modals/_one_hot_encode_modal.html" %}
				{% include "includes/modals/_fill_nulls_mean_modal.html" %}
				{% include "includes/modals/_fill_nulls_median_modal.html" %}
				{% include "includes/modals/_fill_nulls_custom_modal.html" %}
				{% include "includes/modals/_predicate_modal.html" %}
				{% include "includes/modals/_extract_date_modal.html" %}
				{% include "includes/modals/_normalize_modal.html" %}

			{% endif %}
		
		
			<div id="tablediv" class="col-sm-12">
				<style>
					table {
		       			border-collapse: collapse;
		        		float:left;
						padding:3px;
						border-radius: 3px;
					}

			        td, th {
			         	font-size: 15px;
			            text-align: left;
			            padding: 8px;
			        }

			        table thead {
			        	background-color: lightgrey;
			        }

			        table tbody tr:nth-child(even) {
			        	background-color: #eaeaea;
			        }

			        .dataTables_filter {
			        	display: none;
			        }

				</style>

				<!-- TABLE -->

				<table id="mytable">
					<thead>
						<tr>
							{% for attr in attribute_list %}
								<th>
									{{ attr }}
			                        <form method="post" id="deleteform_{{ attr }}" action="{{ url_for('transf_callbacks.transform_deleteattr', dataset_id=dataset_info.setid, tablename=table_name, attrname=attr) }}" id="deleteform_{{ attr }}">
			                       <button style="border: none; background-color: transparent;" type="submit" id="delete_{{ attr }}" ><span class="glyphicon glyphicon-trash"></span></button>
			                        </form>
								</th>
							{% endfor %}
						</tr>
					</thead>
				</table>
			</div>
		</div>

		<!-- TABLE -->
		<script>
			$(document).ready( function () {
    			var table = $('#mytable').DataTable( {
    				scrollX: true,
    				scrollY: true,
    				processing: true,
    				serverSide: true,
    				autoWidth: false,
    				fixedColumns: false,
    				order: [[1, 'asc']], 
    				ajax: '{{ url_for("dataset_pages._get_table", dataset_id=dataset_info.setid, tablename=table_name, original = original) }}'
    			} );

    			$('#transbutton').click(function(){
    				table.ajax.reload();
    			});
    	
    		} );
		</script>
	</div>


	{% include "includes/scripts/_new_table_form_script.html" %}
	{% include "includes/scripts/_type_conversion_script.html" %}
	{% include "includes/scripts/_graph_script.html" %}
	{% include "includes/scripts/_predicate_script.html" %}


{% endblock %}
