{% extends 'layout.html' %}

{% block body %}
	<div class="jumbotron" style="padding: 1%;">
		<div class="row">
			<div class="col-sm-3 text-left">
				<a href="{{ url_for('dataset_pages.home', dataset_id=dataset_info.setid) }}"
				class="btn btn-primary">Tables</a>
			</div>
			<div class="col-sm-6 text-center">
				<h2>{{ dataset_info.name }}</h2>
				{% if original != True %}
					<p>{{ dataset_info.desc }}</p>
				{% else %}
					<p>Original Table</p>
				{% endif %}
			</div>
			<div class="col-sm-3 text-right">
				<div>
					<a id="file" href="#" class="btn btn-primary" data-toggle="modal" data-target="#downloadFormModal_{{ table }}">Download</a>
					{% include "includes/modals/_download_modal.html" %}
				</div>
			</div>
		</div>
	</div>    		
  
  	{% if original != True %}
	  	<div class="panel-group" id="accordion">
		    <div class="panel panel-default">
		      	<div class="panel-heading">
		        	<h4 class="panel-title">
		          		<a data-toggle="collapse" data-parent="#accordion" href="#view">View</a>
		        	</h4>
		      	</div>
		      	<div id="view" class="panel-collapse collapse">
		        	<div class="panel-body">
		        		<div>
			        		<div>
			        			{% from "includes/_formhelpers.html" import render_field %}
			        			<form name="select_attr">
			        				{{ attr_form.hidden_tag() }}
					        		<div class="form-group" style="width: 20%;">
					        			{{render_field(attr_form.view_attr, class_="form-control")}}
					        		</div>
					        	</form>
				        	</div>
				       	    <div style="float: right;" id="col_stats"></div>
				        	</br>
				        	</br>
				        	</br>
				        	</br>
				        	</br>
				        	</br>
				        	<div>
					        	<div class="text-center" style="display: inline-block;" id="chart_freq"></div>
					        	<div class="text-center" style="display: inline-block;" id="hist_num"></div>
					        </div>

					    </div>
		        	</div>
		      	</div>
		    </div>
		    {% if (perm_type == 'admin' or perm_type == 'write') %}
			    <div class="panel panel-default">
			      	<div class="panel-heading">
			        	<h4 class="panel-title">
			         		<a data-toggle="collapse" data-parent="#accordion" href="#transform">Transform</a>
			        	</h4>
			      	</div>
			      	<div id="transform" class="panel-collapse collapse">
			      		<div class="panel-body">
			      			<div class="panel-group" id="accordion2">
						        <div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#tc">Attribute Type Conversion</a>
    	</h4>
  	</div>
  	<div id="tc" class="panel-collapse collapse">
  		<div class="panel-body">
  			{% from "includes/_formhelpers.html" import render_field %}
  			<!-- Type Conversion -->
			<div class="col-sm-12" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_typeconversion', dataset_id=dataset_info.setid, tablename=table_name) }}">
				{{ typeconversion_form.hidden_tag() }}
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(typeconversion_form.select_attr, class_="form-control") }}
				</div>
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(typeconversion_form.new_datatype, class_="form-control") }}
				</div>
				<div class="form-group" style="width: 20%; display: inline-block;" id="char_div">
					{{render_field(typeconversion_form.char_amount, class_="form-control", placeholder="Character Amount") }}
				</div>
				<div class="form-group" style="width: 20%; display: inline-block;" id="date_div">
					{{render_field(typeconversion_form.date_type, class_="form-control") }}
				</div>

				<p style="display: inline-block;"><input type="submit" id="typeconversion" class="btn btn-primary" value="Convert Attribute Type"></p>
				</br>
				<div class="form-group" style="width: 8%; display: inline-block;">
					{{render_field(typeconversion_form.make_backup, class_="checkbox-inline", id="tcc") }}
				</div>
				<div class="form-group" style="width: 20%; display: inline-block;" id="tcdiv">
					{{render_field(typeconversion_form.backup_name, class_="form-control") }}
				</div>
				</form>
			</div>
			<!-- Type Conversion -->
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#fr">Find and Replace</a>
    	</h4>
  	</div>
  	<div id="fr" class="panel-collapse collapse">
  		<div class="panel-body">
  			<!-- Find & Replace -->
  			<div class="col-sm-12" style="overflow-x: auto;">
  				{% from "includes/_formhelpers.html" import render_field %}
				<form method="post" action="{{ url_for('transf_callbacks.transform_findreplace', dataset_id=dataset_info.setid, tablename=table_name) }}">
				{{ findrepl_form.csrf_token }}
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(findrepl_form.select_attr, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(findrepl_form.search, class_="form-control", placeholder="Searchterm")}}
				</div>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(findrepl_form.replacement, class_="form-control", placeholder="Replacement")}}  
				</div>
				<p style="display: inline-block;"><input type="submit" id="findrepl" class="btn btn-primary" value="Find and Replace"></p>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(findrepl_form.exactmatch, class_="checkbox-inline", placeholder="True")}}
				</div>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(findrepl_form.replace_full_match, class_="checkbox-inline", placeholder="True")}}
				</div>
				</form>
			</div>
			<!-- Find & Replace  -->		
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#frr">Find and Replace with Regex</a>
    	</h4>
  	</div>
  	<div id="frr" class="panel-collapse collapse">
  		<div class="panel-body">
  			{% from "includes/_formhelpers.html" import render_field %}
  			<!-- Regex Find & Replace -->
  			<div class="col-sm-12" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_findreplaceregex', dataset_id=dataset_info.setid, tablename=table_name) }}">
				{{ findrepl_form.csrf_token }}
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(regexfindreplace_form.select_attr, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(regexfindreplace_form.regex, class_="form-control", placeholder="Search Regex")}}
				</div>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(regexfindreplace_form.replacement, class_="form-control", placeholder="Replacement")}}  
				</div>
				<p style="display: inline-block;"><input type="submit" id="findrepl" class="btn btn-primary" value="Find and Replace"></p>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(regexfindreplace_form.case_sens, class_="checkbox-inline", placeholder="True")}}
				</div>
				</form>
			</div>
			<!-- Regex Find & Replace  -->
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#pr">Delete Rows Using Predicate</a>
    	</h4>
  	</div>
  	<div id="pr" class="panel-collapse collapse">
  		<div class="panel-body">
  			{% from "includes/_formhelpers.html" import render_field %}
  			<!-- Predicates -->
			<div class="col-sm-12" style="overflow-x: auto;">
				{% include "includes/_predicates.html" %}
			</div>
			<!-- Predicates -->	
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#da">Delete Attribute</a>
    	</h4>
  	</div>
  	<div id="da" class="panel-collapse collapse">
  		<div class="panel-body">
  			{% from "includes/_formhelpers.html" import render_field %}
  			<!-- Delete Attribute -->
  			<div class="col-sm-12" style="overflow-x: auto;">
  				<h5><u><strong>Delete an Attribute</strong></u></h5>
				<form method="post" action="{{ url_for('transf_callbacks.transform_deleteattr', dataset_id=dataset_info.setid, tablename=table_name) }}">
				{{ delete_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(delete_form.select_attr, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Delete Attribute"></p>
				</form>
			</div>
			<!-- Delete Attribute -->
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#do">Delete Outliers</a>
    	</h4>
  	</div>
  	<div id="do" class="panel-collapse collapse">
  		<div class="panel-body">
  			{% from "includes/_formhelpers.html" import render_field %}
  			<!-- Delete Outliers -->
  			<div class="col-sm-12" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_deleteOutlier', dataset_id=dataset_info.setid,
					tablename=table_name) }}">
				{{ deleteoutlier_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(deleteoutlier_form.select_attr, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(deleteoutlier_form.select_comparison, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(deleteoutlier_form.value, class_="form-control", placeholder="Value")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Delete Outlier"></p>
				</form>
			</div>
			<!-- Delete Outliers -->
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#nuz">Normalize Using Z-Score</a>
    	</h4>
  	</div>
  	<div id="nuz" class="panel-collapse collapse">
  		<div class="panel-body">
  			<!-- Normalize Using Z-Score -->
			<div class="col-sm-6" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_zscorenormalisation', dataset_id=dataset_info.setid,
					tablename=table_name) }}">
				{{ zscoreform.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(zscoreform.select_attr, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="NUZ" class="btn btn-primary" value="Normalize"></p>
				</form>
			</div>
			<!-- Normalize Using Z-Score -->
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#dew">Discretize Equal Width</a>
    	</h4>
  	</div>
  	<div id="dew" class="panel-collapse collapse">
  		<div class="panel-body">
			<!-- Discretize Equal Width -->
  			<div class="col-sm-6" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_discretizeEqualWidth', dataset_id=dataset_info.setid, tablename=table_name) }}">
				{{ discretizeWidth_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(discretizeWidth_form.select_attr, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Discretize Equal Width"></p>
				</form>
			</div>
			<!-- Discretize Equal Width  -->
		</div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#def">Discretize Equal Frequency</a>
    	</h4>
  	</div>
  	<div id="def" class="panel-collapse collapse">
  		<div class="panel-body">
			<!-- Discretize Equal Frequency -->
  			<div class="col-sm-6" style="overflow-x: auto;">
  				<h5><u><strong>Discretize with Equal Frequency</strong></u></h5>
				<form method="post" action="{{ url_for('transf_callbacks.transform_discretizeEqualFreq', dataset_id=dataset_info.setid, tablename=table_name) }}">
				{{ discretizeFreq_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(discretizeFreq_form.select_attr, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Discretize Equal Frequency"></p>
				</form>
			</div>
			<!-- Discretize Equal Frequency  -->
		</div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#dcr">Discretize Custom Range</a>
    	</h4>
  	</div>
  	<div id="dcr" class="panel-collapse collapse">
  		<div class="panel-body">
			<!-- Discretize Equal Width -->
  			<div class="col-sm-12" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_discretizeCustomRange', dataset_id=dataset_info.setid, tablename=table_name) }}">
				{{ discretizeCustom_form.csrf_token }}
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(discretizeCustom_form.select_attr, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(discretizeCustom_form.ranges, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 15%; display: inline-block;">
					{{render_field(discretizeCustom_form.interval_spec, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Discretize Custom Range"></p>
				</form>
			</div>
			<!-- Discretize Equal Width  -->
		</div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#edt">Extract Part of Date</a>
    	</h4>
  	</div>
  	<div id="edt" class="panel-collapse collapse">
  		<div class="panel-body">
  			{% from "includes/_formhelpers.html" import render_field %}
  			<!-- Extract Date/Time -->
  			<div class="col-sm-12" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_extractdatetime', dataset_id=dataset_info.setid,
					tablename=table_name) }}">
				{{ extract_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(extract_form.select_attr, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 20%; display: inline-block;">
					{{render_field(extract_form.select_extracttype, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Extract"></p>
				</form>
			</div>
			<!-- Extract Date/Time -->
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#ohe">One Hot Encoding</a>
    	</h4>
  	</div>
  	<div id="ohe" class="panel-collapse collapse">
  		<div class="panel-body">
  			{% from "includes/_formhelpers.html" import render_field %}
  			<!-- One Hot Encoding -->
      		<div class="col-sm-6" style="overflow-x: auto;">
	        	<form method="post" action="{{ url_for('transf_callbacks.transform_onehotencoding', dataset_id=dataset_info.setid,
	        	tablename=table_name) }}">
				{{ onehotencodingform.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(onehotencodingform.select_attr, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="OHE" class="btn btn-primary" value="One Hot Encode"></p>
				</form>
			</div>
			<!-- One Hot Encoding -->
        </div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#fnmean">Fill Nulls - Mean</a>
    	</h4>
  	</div>
  	<div id="fnmean" class="panel-collapse collapse">
  		<div class="panel-body">
			<!-- Fill Nulls Mean -->
			<div class="col-sm-6" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_fillNullsMean', dataset_id=dataset_info.setid,
					tablename=table_name) }}">
				{{ fillnullmean_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(fillnullmean_form.select_attr, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Fill Nulls Mean"></p>
				</form>
			</div>
		<!-- Fill Nulls Mean -->
		</div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#fnmedian">Fill Nulls - Median</a>
    	</h4>
  	</div>
  	<div id="fnmedian" class="panel-collapse collapse">
  		<div class="panel-body">
			<!-- Fill Nulls Median -->
  			<div class="col-sm-6" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_fillNullsMedian', dataset_id=dataset_info.setid,
					tablename=table_name) }}">
				{{ fillnullmedian_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(fillnullmedian_form.select_attr, class_="form-control")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Fill Nulls Median"></p>
				</form>
			</div>
			<!-- Fill Nulls Median -->
		</div>
	</div>
</div>

<div class="panel panel-default">
  	<div class="panel-heading">
    	<h4 class="panel-title">
     		<a data-toggle="collapse" data-parent="#accordion2" href="#fnc">Fill Nulls - Custom Value</a>
    	</h4>
  	</div>
  	<div id="fnc" class="panel-collapse collapse">
  		<div class="panel-body">
			<!-- Fill Nulls Custom Value -->
  			<div class="col-sm-6" style="overflow-x: auto;">
				<form method="post" action="{{ url_for('transf_callbacks.transform_fillNullsCustomValue', dataset_id=dataset_info.setid,
					tablename=table_name) }}">
				{{ fillnullcustom_form.csrf_token }}
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(fillnullcustom_form.select_attr, class_="form-control")}}
				</div>
				<div class="form-group" style="width: 30%; display: inline-block;">
					{{render_field(fillnullcustom_form.replacement, class_="form-control", placeholder="Replacement")}}
				</div>
				<p style="display: inline-block;"><input type="submit" id="delete" class="btn btn-primary" value="Fill Nulls Custom"></p>
				</form>
			</div>
			<!-- Fill Nulls Median -->
		</div>
	</div>
</div>




							</div>    			
				        </div>
		     		</div>
		    	</div>
		    {% endif %}
	  	</div>	
	{% endif %}

  	<div class="xs-center">
    	<div class="row">
	    	<div class="col-sm-3 text-left">
	    		<input type="text" id="input" placeholder="Search Page No" style="border-style: solid; border-width: 1px; border-radius: 3px;"/>
	    		{% if original != True %}
					<button onclick="page_search()"><i class="glyphicon glyphicon-arrow-right"></i></button>
	    		{% else %}
	    			<button onclick="page_search_original()"><i class="glyphicon glyphicon-arrow-right"></i></button>
	    		{% endif %}

				<script type="text/javascript">
				function page_search(){
					if(document.getElementById('input').value != "") {
				    	if(!isNaN(document.getElementById('input').value))
				    		window.location.href = '/dataset/{{ dataset_info.setid }}/{{ table_name }}/' + document.getElementById('input').value;
					}
				 }
				function page_search_original(){
					if(document.getElementById('input').value != "") {
				    	if(!isNaN(document.getElementById('input').value))
				    		window.location.href = '/dataset/{{ dataset_info.setid }}/{{ table_name }}/original/' + document.getElementById('input').value;
					}
				 }

				</script>
			</div>

			<div class="col-sm-6"></div>

		    <div class="col-sm-3 text-right">
		    	<input type="text" id="searchInput" placeholder="Search Entry" style="border-style: solid; border-width: 1px; border-radius: 3px;" />
		    </div>
		</div>
	</div>

	<div class="xs-center">
		<!--ENTRYCOUNT-->
		<div class="col-sm-3 text-left">
		</br>
			{% from "includes/_formhelpers.html" import render_field %}
			{% if original != True %}
				<form id="entrycount_form" method="post" action="{{ url_for('dataset_pages.set_session_rowcount', redirect_type='CURRENT') }}">
			{% else %}
				<form id="entrycount_form" method="post" action="{{ url_for('dataset_pages.set_session_rowcount', redirect_type='ORIGINAL') }}">
			{% endif %}	
				{{ entrycount_form.hidden_tag() }}
				<div class="form-group" style="width: 30%;">
					{{render_field(entrycount_form.entry_count, class_="form-control")}}
			    </div>
			</form>
		</div>
		<!--ENTRYCOUNT-->
		{% if original != True %}
			<div class="col-sm-6 text-center" style="overflow-x: auto;">
		   		<ul class="pagination">
		   			{% if page_indices|length > 1 %}
		    			{% for index in page_indices %}
		    				{% if index == "..." %}
		    					<li class="page-item hidden-xs"><a class="page-link" style="color: black;">...</a></li>
		    				{% else %}
		    					{% if index|int == current_page %}
		    						<style>
		    							.active {
		    								color: red !important;
		    							}
		    						</style>
			    					<li class="page-item active"><a class="page-link" href="{{ url_for('dataset_pages.table', dataset_id=dataset_info.setid, tablename=table_name, page_nr=index) }}" style="color: black;"">
			    						{{ index }}</a></li>
			    				{% else %}
			    					<li class="page-item"><a class="page-link" href="{{ url_for('dataset_pages.table', dataset_id=dataset_info.setid, tablename=table_name, page_nr=index) }}" style="color: black;"">
			    						{{ index }}</a></li>
		    					{% endif %}
		    				{% endif %}
		    			{% endfor %}
		    		{% else %}
			    			<li class="page-item active"><a class="page-link" style="color: black;"">
				    						{{ page_indices[0] }}</a></li>
			    	{% endif %}

	    		</ul>	
	    	</div>
	    {% else %}
	    	<div class="col-sm-6 text-center" style="overflow-x: auto;">
		   		<ul class="pagination">
		   			{% if page_indices|length > 1 %}
		    			{% for index in page_indices %}
		    				{% if index == "..." %}
		    					<li class="page-item hidden-xs"><a class="page-link" style="color: black;">...</a></li>
		    				{% else %}
		    					{% if index|int == current_page %}
		    						<style>
		    							.active {
		    								color: red !important;
		    							}
		    						</style>
			    					<li class="page-item active"><a class="page-link" href="{{ url_for('dataset_pages.table_original', dataset_id=dataset_info.setid, tablename=table_name, page_nr=index) }}" style="color: black;"">
			    						{{ index }}</a></li>
			    				{% else %}
			    					<li class="page-item"><a class="page-link" href="{{ url_for('dataset_pages.table_original', dataset_id=dataset_info.setid, tablename=table_name, page_nr=index) }}" style="color: black;"">
			    						{{ index }}</a></li>
		    					{% endif %}
		    				{% endif %}
		    			{% endfor %}
		    		{% else %}
			    			<li class="page-item active"><a class="page-link" style="color: black;"">
				    						{{ page_indices[0] }}</a></li>
			    	{% endif %}

	    		</ul>	
	    	</div>
	    {% endif %}
	</div>

	<div class="text-center">
		<style>
			table {
       			border-collapse: collapse;
        		float:left;
				padding:3px;
				border-radius: 3px;
			}

	        td, th {
	         	font-size: 15px;
	            text-align: left;
	            padding: 8px;
	        }

	        table thead {
	        	background-color: lightgrey;
	        }

	        table tbody tr:nth-child(even) {
	        	background-color: #eaeaea;
	        }

	        .dataTables_filter {
	        	display: none;
	        }

		</style>
		<div>
			{{ table_data|safe }}
		</div>
		<script>
			$(document).ready( function () {
    			var table = $('#mytable').DataTable( {
    				scrollX: true,
    				scrollY: true,
    				paging: false,
    				lengthChange: false,
    				bInfo: false,
    				autoWidth: false,
    				ordering: false
    			} );
    		} );

    		var $rows = $('#mytable tbody tr');
			$('#searchInput').keyup(function() {
			    var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
			    
			    $rows.show().filter(function() {
			        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
			        return !~text.indexOf(val);
			    }).hide();

			});

			$('#mytable thead').on('click', 'tr th', function() {
				var cell = $(this).text();
				alert(cell);
			});
		</script>
	</div>

	<script>
		
			$('#tcdiv').hide();


			
	</script>

	<script>
		
		$('#entry_count').change(function() {
			$('#entrycount_form').submit();
		});

		$('#tcc').change(function() {
			if($('#tcc').is(':checked')){
				$('#tcdiv').show();
			}
			else {
				$('#tcdiv').hide();
			}
		});

	</script>

	<script>	
		$('#view_attr').ready(function() {
			var input = {
				view_attr: $('#view_attr option:selected').text()
			}
			$.get("{{ url_for('dataset_pages._get_hist_num', dataset_id=dataset_info.setid, tablename=table_name, attr_name=input) }}", input, function(response) {
					if(response != "N/A") {
						$('#hist_num').append("<h5>Numerical Histogram</h5>");
						$('#hist_num').append(response);
					}
				})
			$.get("{{ url_for('dataset_pages._get_chart_freq', dataset_id=dataset_info.setid, tablename=table_name, attr_name=input) }}", input, function(response) {
				if(response != "N/A") {
					$('#chart_freq').append("<h5>Frequency Pie Chart</h5>");
					$('#chart_freq').append(response);
				}
			})

			$.get("{{ url_for('dataset_pages._get_colstats', dataset_id=dataset_info.setid, tablename=table_name, attr_name=input) }}", input, function(response) {
				if(response != "") {	
					$('#col_stats').append(response);
				}
			})
		});

		$('#view_attr').change(function() {
			$('#hist_num').empty();
			$('#chart_freq').empty();
			$('#col_stats').empty();

			var input = {
				view_attr: $('#view_attr option:selected').text()
			}
			$.get("{{ url_for('dataset_pages._get_hist_num', dataset_id=dataset_info.setid, tablename=table_name, attr_name=input) }}", input, function(response) {
				if(response != "N/A") {
						$('#hist_num').append("<h5>Numerical Histogram</h5>");
						$('#hist_num').append(response);
				}
			});
			$.get("{{ url_for('dataset_pages._get_chart_freq', dataset_id=dataset_info.setid, tablename=table_name, attr_name=input) }}", input, function(response) {
			if(response != "N/A") {
					$('#chart_freq').append("<h5>Frequency Pie Chart</h5>");
					$('#chart_freq').append(response);
			}
			});
			$.get("{{ url_for('dataset_pages._get_colstats', dataset_id=dataset_info.setid, tablename=table_name, attr_name=input) }}", input, function(response) {
				if(response != "") {	
					$('#col_stats').append(response);
				}
			})
		});
	</script>

	<script>
		$(function() {
			$('#pred_2_attr').hide()
			$('#pred_2_op').hide()
			$('#pred_2_input').hide()
			$('#pred_2_select').hide()
			$('#pred_3_attr').hide()
			$('#pred_3_op').hide()
			$('#pred_3_input').hide()

			$('#select1').change(function() {
				if($('#select1 option:selected').text() == "AND" || $('#select1 option:selected').text() == "OR"){
					$('#pred_2_attr').show()
					$('#pred_2_op').show()
					$('#pred_2_input').show()
					$('#pred_2_select').show()
				}
				else {
					$('#pred_2_attr').hide()
					$('#pred_2_op').hide()
					$('#pred_2_input').hide()
					$('#pred_2_select').hide()
					$('#pred_3_attr').hide()
					$('#pred_3_op').hide()
					$('#pred_3_input').hide()
					$('#select2').prop('selectedIndex', 0)
				}
			});

			$('#select2').change(function() {
				if($('#select2 option:selected').text() == "AND" || $('#select2 option:selected').text() == "OR"){
					$('#pred_3_attr').show()
					$('#pred_3_op').show()
					$('#pred_3_input').show()
				}
				else {
					$('#pred_3_attr').hide()
					$('#pred_3_op').hide()
					$('#pred_3_input').hide()
				}
			});
		});
	</script>
	

	<script>

		$(function() {

			var dropdown = {
				attribute: $('#attribute'),
				options: $('#typeOptions'),
				char_amount: $('#char_amount'),
				date_type: $('#date_type')
			};

			updateOptions();

			function updateOptions() {
				
				$('#char_div').hide();
				$('#date_div').hide();

				var send = {
					attribute: dropdown.attribute.val()
				};
				dropdown.options.attr('disabled', 'disabled');
				dropdown.options.empty();
				$.getJSON("{{ url_for('dataset_pages._get_options', dataset_id=dataset_info.setid, tablename=table_name, attr=send) }}", send, function(data) {
					data.forEach(function(item) {
						dropdown.options.append (
							$('<option>', {
								value: item[0],
								text: item[1]
							})
						);
					});
					dropdown.options.removeAttr('disabled');
				});	
			}

			$('#attribute').change(function() {
				updateOptions();
			});

			$('#typeOptions').change(function() {
				if($('#typeOptions option:selected').text() == "CHAR(n)" || $('#typeOptions option:selected').text() == "VARCHAR(n)"){
					$('#char_div').show();
				}
				else {
					$('#char_div').hide();
				}			
			});
		});

	</script>

	<script>

		$(function() {

			var dropdown = {
				attribute: $('#attribute'),
				options: $('#typeOptions'),
				char_amount: $('#char_amount'),
				date_type: $('#date_type')
			};

			updateDateTime();

			function updateDateTime() {
				$('#date_div').hide();

				var type = {
					options: dropdown.options.val()
				}

				if (type.options == "") {
					type.options = "VARCHAR(255)";
				}

				dropdown.date_type.attr('disabled', 'disabled');
				dropdown.date_type.empty();
				$.getJSON("{{ url_for('dataset_pages._get_datetype', dataset_id=dataset_info.setid, tablename=table_name, attr=type) }}", type, function(data) {
					data.forEach(function(item) {
						dropdown.date_type.append (
							$('<option>', {
								value: item[0],
								text: item[1]
							})
						);
					});
					dropdown.date_type.removeAttr('disabled');
				});

			}
			$('#typeOptions').change(function() {
				updateDateTime();
				if($('#typeOptions option:selected').text() == "DATE" || $('#typeOptions option:selected').text() == "TIME" || $('#typeOptions option:selected').text() == "TIMESTAMP"){
					$('#date_div').show();
				}
				else {
					$('#date_div').hide();
				}			
			});
		});

	</script>

{% endblock %}
